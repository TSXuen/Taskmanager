<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Task Manager</title>
  <style>
  body{margin:0;padding:0;font-family:sans-serif;background:#f0f4f8;display:flex;justify-content:center;padding:40px 10px;}
  .container{width:100%;max-width:600px;background:#fff;padding:25px 30px;border-radius:15px;box-shadow:0 15px 30px rgba(0,0,0,0.1);}
  h2{text-align:center;margin-bottom:20px;color:#333;}
  .form-group{display:flex;flex-direction:column;gap:10px;margin-bottom:20px;}
  input,textarea{padding:12px 15px;border-radius:8px;border:1px solid #ccc;font-size:14px;transition:border 0.2s;}
  input:focus,textarea:focus{outline:none;border-color:#6B73FF;box-shadow:0 0 5px rgba(107,115,255,0.5);}
  button{padding:12px 20px;border:none;border-radius:8px;background:#6B73FF;color:#fff;font-weight:bold;cursor:pointer;transition:all 0.3s ease;}
  button:hover{background:#000DFF;transform:translateY(-2px);box-shadow:0 4px 10px rgba(0,0,0,0.15);}
  .task-item{background:#fafafa;padding:15px 20px;border-radius:10px;margin-bottom:12px;display:flex;justify-content:space-between;align-items:center;transition:all 0.3s ease;box-shadow:0 5px 15px rgba(0,0,0,0.05);}
  .task-item.completed{background:#d4edda;text-decoration:line-through;color:#2e7d32;}
  .task-buttons{display:flex;gap:10px;}
  @media(max-width:480px){.container{padding:20px;}button{width:100%;}.task-buttons{flex-direction:column;}}
</style>
</head>
<body>
<div class="container">
  <h2>Task Manager</h2>
  <div class="form-group">
    <input type="text" id="title" placeholder="Task Title">
    <textarea id="description" placeholder="Description"></textarea>
    <button onclick="createTask()">Add Task</button>
  </div>
  <div id="tasks"></div>
</div>

<script>
const api="http://localhost:8081/api/tasks";

function formatDate(datetime) {
    const d = new Date(datetime);
    const year = d.getFullYear();
    const month = String(d.getMonth() + 1).padStart(2, '0');
    const day = String(d.getDate()).padStart(2, '0');
    const hours = String(d.getHours()).padStart(2, '0');
    const minutes = String(d.getMinutes()).padStart(2, '0');
    const seconds = String(d.getSeconds()).padStart(2, '0');
    return `${day}/${month}/${year} ${hours}:${minutes}:${seconds}`;
}

async function fetchTasks(){
  const res = await fetch(api);
  const data = await res.json();
  const container = document.getElementById("tasks");
  container.innerHTML="";
  data.forEach(t=>{
    const div=document.createElement("div");
    div.className="task-item"+(t.completed?" completed":"");
    div.innerHTML=`
      <div>
        <strong>${t.title}</strong><br>
        <small style="color:gray;">Created: ${formatDate(t.createdAt)}</small><br>
        ${t.description||""}
      </div>
      <div class="task-buttons">
        <button onclick="toggleComplete(${t.id},${t.completed})">${t.completed?"Undo":"Complete"}</button>
        <button onclick="deleteTask(${t.id})" style="background:#FF4C4C;">Delete</button>
      </div>
    `;
    container.appendChild(div);
  });
}

async function createTask(){
  const title=document.getElementById("title").value.trim();
  const description=document.getElementById("description").value.trim();
  if(!title) return alert("Title required");

  await fetch(api,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({title,description})
  });
  document.getElementById("title").value="";
  document.getElementById("description").value="";
  fetchTasks();
}

async function toggleComplete(id,completed){
  await fetch(`${api}/${id}`,{
    method:"PUT",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({completed:!completed,title:"",description:""})
  });
  fetchTasks();
}

async function deleteTask(id){
  if(!confirm("Are you sure you want to delete this task?")) return;
  await fetch(`${api}/${id}`,{method:"DELETE"});
  fetchTasks();
}

fetchTasks();
</script>
</body>
</html>

